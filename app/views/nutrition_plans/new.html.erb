<div class="nutrition-plan-layout">
  <!-- Left Sidebar -->
  <aside class="left-sidebar">
    <nav class="sidebar-nav">
      <%= link_to nutritionist_dashboard_path, class: "nav-item" do %>
        <span class="nav-icon">üìä</span>
        <span>Dashboard</span>
      <% end %>
      <%= link_to patients_path, class: "nav-item" do %>
        <span class="nav-icon">üë•</span>
        <span>Pacientes</span>
      <% end %>
      <a href="#" class="nav-item active">
        <span class="nav-icon">üçé</span>
        <span>Planes Nutricionales</span>
      </a>
      <a href="#" class="nav-item">
        <span class="nav-icon">ü§ñ</span>
        <span>Copiloto IA</span>
      </a>
      <a href="#" class="nav-item">
        <span class="nav-icon">‚öôÔ∏è</span>
        <span>Configuraciones</span>
      </a>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Header -->
    <div class="page-header">
      <div class="breadcrumb">
        <span class="breadcrumb-item">Paciente</span>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-item">ver</span>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-item">planes nutricionales</span>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-item active">nuevo plan</span>
      </div>
      
      <div class="page-title-section">
        <h1 class="page-title">Crear Plan Nutricional para <%= @patient.first_name %> <%= @patient.last_name %></h1>
        <div class="page-actions">
          <button class="btn btn-outline">üóÇÔ∏è Plantillas</button>
          <button class="btn btn-primary">‚ú® Generar con IA</button>
          <button class="btn btn-outline">‚Ü©Ô∏è Volver al Paciente</button>
        </div>
      </div>
    </div>

    <!-- Navigation Tabs -->
    <nav class="content-tabs">
      <a href="#" class="tab-item">Resumen</a>
      <a href="#" class="tab-item active">Planes Nutricionales</a>
      <a href="#" class="tab-item">Historial del Paciente</a>
      <a href="#" class="tab-item">Registro de Comidas</a>
      <a href="#" class="tab-item">Controles Diarios</a>
    </nav>

    <!-- Form Content -->
    <%= simple_form_for [@patient, @nutrition_plan], html: { class: "nutrition-form" } do |f| %>
      
      <!-- Informaci√≥n General del Plan -->
      <div class="form-section">
        <h2 class="section-title">Informaci√≥n General del Plan</h2>
        <div class="form-grid">
          <div class="form-group">
            <%= f.input :objective, label: "Objetivo", input_html: { class: "form-input" }, wrapper_html: { class: "input-wrapper" } %>
          </div>
          <div class="form-group">
            <%= f.input :start_date, label: "Fecha de Inicio", as: :date, input_html: { class: "form-input", value: "01/01/2024" }, wrapper_html: { class: "input-wrapper" } %>
          </div>
          <div class="form-group">
            <%= f.input :end_date, label: "Fecha de Fin", as: :date, input_html: { class: "form-input", value: "01/31/2024" }, wrapper_html: { class: "input-wrapper" } %>
          </div>
        </div>
        
        <div class="form-group full-width">
          <label class="form-label">Notas Cl√≠nicas (opcional)</label>
          <textarea class="form-textarea" placeholder="Alergias, condiciones m√©dicas, nutricionalmente..." rows="3"></textarea>
        </div>
      </div>

      <!-- Recomendaciones Nutricionales -->
      <div class="form-section">
        <h2 class="section-title">Recomendaciones Nutricionales</h2>
        
        <!-- Objetivo Cal√≥rico Diario -->
        <div class="caloric-objective">
          <label class="objective-label">Objetivo Cal√≥rico Diario</label>
          <div class="caloric-slider-container">
            <input type="range" class="caloric-slider" min="1200" max="3500" value="2200" id="caloricSlider">
            <div class="caloric-value">
              <span id="caloricValue">2200</span>
              <span class="caloric-unit">kcal</span>
            </div>
          </div>
        </div>

        <!-- Macronutrientes -->
        <div class="macros-inputs">
          <div class="macro-input-group">
            <label class="macro-input-label">Prote√≠nas (g)</label>
            <%= f.input :protein, label: false, input_html: { class: "macro-input", value: "165", placeholder: "165" }, wrapper_html: { class: "macro-wrapper" } %>
          </div>
          <div class="macro-input-group">
            <label class="macro-input-label">Carbohidratos (g)</label>
            <%= f.input :carbs, label: false, input_html: { class: "macro-input", value: "220", placeholder: "220" }, wrapper_html: { class: "macro-wrapper" } %>
          </div>
          <div class="macro-input-group">
            <label class="macro-input-label">Grasas (g)</label>
            <%= f.input :fat, label: false, input_html: { class: "macro-input", value: "73", placeholder: "73" }, wrapper_html: { class: "macro-wrapper" } %>
          </div>
        </div>
      </div>

      <!-- Distribuci√≥n de Comidas -->
      <div class="form-section">
        <h2 class="section-title">Distribuci√≥n de Comidas</h2>
        
        <div class="meal-section">
          <h3 class="meal-title">Desayuno</h3>
          <textarea class="meal-textarea" placeholder="Yogur griego con frutas y avena..." rows="2"></textarea>
          <div class="meal-calories">
            <input type="number" class="calorie-input" placeholder="450">
            <span class="calorie-unit">kcal</span>
          </div>
        </div>

        <div class="meal-section">
          <h3 class="meal-title">Almuerzo</h3>
          <textarea class="meal-textarea" placeholder="Pechuga de pollo a la plancha, arroz y ensalada de espinaca..." rows="2"></textarea>
          <div class="meal-calories">
            <input type="number" class="calorie-input" placeholder="700">
            <span class="calorie-unit">kcal</span>
          </div>
        </div>

        <div class="meal-section">
          <h3 class="meal-title">Cena</h3>
          <textarea class="meal-textarea" placeholder="Salm√≥n a la plancha con verduras..." rows="2"></textarea>
          <div class="meal-calories">
            <input type="number" class="calorie-input" placeholder="650">
            <span class="calorie-unit">kcal</span>
          </div>
        </div>

        <div class="meal-section">
          <h3 class="meal-title">Snacks</h3>
          <textarea class="meal-textarea" placeholder="Un pu√±ado de almendras, fresas de temporada..." rows="2"></textarea>
          <div class="meal-calories">
            <input type="number" class="calorie-input" placeholder="450">
            <span class="calorie-unit">kcal</span>
          </div>
        </div>
      </div>

      <!-- Notas Adicionales y Consideraciones Especiales -->
      <div class="form-section">
        <h2 class="section-title">Notas Adicionales y Consideraciones Especiales</h2>
        
        <div class="notes-section">
          <%= f.input :notes, label: false, as: :text, 
              input_html: { 
                class: "notes-textarea", 
                placeholder: "Recordatorios, consejos de preparaci√≥n, marcas recomendadas...", 
                rows: 6 
              }, 
              wrapper_html: { class: "notes-wrapper" } %>
          
          <div class="checkbox-section">
            <label class="checkbox-container">
              <input type="checkbox" class="notes-checkbox" name="show_notes_to_patient">
              <span class="checkmark"></span>
              <span class="checkbox-label">Mostrar estas notas al paciente</span>
            </label>
          </div>
        </div>
      </div>

      <!-- Resumen Visual del Plan -->
      <div class="form-section">
        <h2 class="section-title">Resumen Visual del Plan</h2>
        
        <div class="visual-summary">
          <!-- Calories Display -->
          <div class="calories-display">
            <div class="calories-number">2200</div>
            <div class="calories-label">kcal/d√≠a</div>
          </div>

          <!-- Plan Timeline -->
          <div class="plan-timeline">
            <div class="timeline-header">
              <span class="timeline-label">L√≠nea de tiempo del plan</span>
              <span class="timeline-end">31 Ago</span>
            </div>
            <div class="timeline-bar">
              <div class="timeline-progress"></div>
            </div>
          </div>

          <!-- Macros Legend -->
          <div class="macros-legend">
            <div class="legend-item">
              <div class="legend-dot carbs-dot"></div>
              <span class="legend-text">40% C</span>
            </div>
            <div class="legend-item">
              <div class="legend-dot protein-dot"></div>
              <span class="legend-text">30% P</span>
            </div>
            <div class="legend-item">
              <div class="legend-dot fat-dot"></div>
              <span class="legend-text">30% F</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <%= link_to "Cancelar", patient_path(@patient), class: "btn btn-outline" %>
        <%= f.submit "Crear Plan Nutricional", class: "btn btn-primary" %>
      </div>
    <% end %>
  </main>

  <!-- Right Sidebar -->
  <aside class="right-sidebar">
    <!-- AI Copilot -->
    <div class="sidebar-card">
      <h3 class="card-title">
        <span class="copilot-icon">ü§ñ</span>
        AI Copilot
      </h3>
      
      <div class="copilot-input-group">
        <input type="text" class="copilot-input" placeholder="Pregunta al asistente...">
        <button class="copilot-button">‚Üí</button>
      </div>

      <div class="quick-suggestions">
        <div class="suggestion-item">Generar opciones con IA</div>
        <div class="suggestion-item">Calcular macros autom√°ticamente</div>
        <div class="suggestion-item">Recomendar alimentos espec√≠ficos</div>
        <div class="suggestion-item">Crear plan semanal</div>
      </div>
    </div>

    <!-- Alertas del Paciente -->
    <div class="sidebar-card">
      <h3 class="card-title">Alertas del Paciente</h3>
      
      <div class="alert-item alert-warning">
        <div class="alert-icon">‚ö†Ô∏è</div>
        <div class="alert-content">
          <span class="alert-title">Paciente con Hipertensi√≥n</span>
          <span class="alert-description">Vigilar sodio. Recomendar alimentos con bajo contenido de sal</span>
        </div>
      </div>

      <div class="alert-item alert-warning">
        <div class="alert-icon">‚ö†Ô∏è</div>
        <div class="alert-content">
          <span class="alert-title">Intolerancia con comidas</span>
          <span class="alert-description">Intolerante a la lactosa. S. gluten libre. Agrupar carbohidratos</span>
        </div>
      </div>
    </div>
  </aside>
</div>

 <!-- Styles -->

<style>
/* Nutrition Plan Layout */
.nutrition-plan-layout {
  display: flex;
  min-height: 100vh;
  background-color: #f8fafc;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
}

/* Left Sidebar */
.left-sidebar {
  width: 240px;
  background: white;
  border-right: 1px solid #e5e7eb;
  padding: 24px 0;
  display: flex;
  flex-direction: column;
}

.sidebar-nav {
  padding: 24px 24px 0 24px;
  flex: 1;
}

.nav-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px;
  margin-bottom: 4px;
  color: #6b7280;
  text-decoration: none;
  border-radius: 8px;
  transition: all 0.15s ease;
  font-weight: 500;
}

.nav-item:hover {
  background: #f3f4f6;
  color: #374151;
}

.nav-item.active {
  background: #fdf2f8;
  color: #ec4899;
}

.nav-icon {
  font-size: 18px;
  width: 20px;
  text-align: center;
}

/* Main Content */
.main-content {
  flex: 1;
  padding: 32px;
  max-width: calc(100vw - 580px);
}

/* Page Header */
.page-header {
  margin-bottom: 24px;
}

.breadcrumb {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 16px;
  font-size: 14px;
  color: #6b7280;
}

.breadcrumb-separator {
  color: #d1d5db;
}

.breadcrumb-item.active {
  color: #1f2937;
  font-weight: 500;
}

.page-title-section {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 24px;
}

.page-title {
  font-size: 28px;
  font-weight: 700;
  color: #1f2937;
  margin: 0;
}

.page-actions {
  display: flex;
  gap: 12px;
}

.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 10px 16px;
  border-radius: 8px;
  font-weight: 500;
  font-size: 14px;
  text-decoration: none;
  border: none;
  cursor: pointer;
  transition: all 0.2s ease;
  white-space: nowrap;
}

.btn-outline {
  background: white;
  border: 1px solid #d1d5db;
  color: #374151;
}

.btn-outline:hover {
  background: #f9fafb;
  border-color: #9ca3af;
}

.btn-primary {
  background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
  color: white;
  border: none;
}

.btn-primary:hover {
  background: linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%);
}

/* Content Tabs */
.content-tabs {
  display: flex;
  gap: 32px;
  margin-bottom: 32px;
  border-bottom: 1px solid #e5e7eb;
}

.tab-item {
  padding: 12px 0;
  color: #6b7280;
  text-decoration: none;
  font-weight: 500;
  border-bottom: 2px solid transparent;
  transition: all 0.2s ease;
}

.tab-item:hover {
  color: #374151;
}

.tab-item.active {
  color: #8b5cf6;
  border-bottom-color: #8b5cf6;
}

/* Form Styles */
.nutrition-form {
  display: flex;
  flex-direction: column;
  gap: 32px;
}

.form-section {
  background: white;
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  padding: 24px;
}

.section-title {
  font-size: 18px;
  font-weight: 600;
  color: #1f2937;
  margin: 0 0 20px 0;
}

.form-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  margin-bottom: 20px;
}

.form-group {
  display: flex;
  flex-direction: column;
}

.form-group.full-width {
  grid-column: span 3;
}

.form-label {
  font-weight: 500;
  color: #374151;
  margin-bottom: 8px;
  font-size: 14px;
}

.form-input, .form-textarea {
  padding: 12px 16px;
  border: 1px solid #d1d5db;
  border-radius: 8px;
  font-size: 14px;
  transition: all 0.2s ease;
}

.form-input:focus, .form-textarea:focus {
  outline: none;
  border-color: #8b5cf6;
  box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
}

.form-textarea {
  resize: vertical;
  min-height: 80px;
}

/* Caloric Objective */
.caloric-objective {
  margin-bottom: 32px;
}

.objective-label {
  font-size: 16px;
  font-weight: 600;
  color: #1f2937;
  margin-bottom: 16px;
  display: block;
}

.caloric-slider-container {
  display: flex;
  align-items: center;
  gap: 20px;
}

.caloric-slider {
  flex: 1;
  height: 6px;
  background: #e5e7eb;
  border-radius: 3px;
  outline: none;
  -webkit-appearance: none;
  position: relative;
}

.caloric-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 20px;
  height: 20px;
  background: #8b5cf6;
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.caloric-slider::-moz-range-thumb {
  width: 20px;
  height: 20px;
  background: #8b5cf6;
  border-radius: 50%;
  cursor: pointer;
  border: none;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.caloric-value {
  display: flex;
  align-items: baseline;
  gap: 4px;
  background: #f8fafc;
  padding: 8px 16px;
  border-radius: 8px;
  border: 1px solid #e5e7eb;
  min-width: 100px;
  justify-content: center;
}

#caloricValue {
  font-size: 18px;
  font-weight: 600;
  color: #1f2937;
}

.caloric-unit {
  font-size: 14px;
  color: #6b7280;
  font-weight: 500;
}

/* Macros Inputs */
.macros-inputs {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
}

.macro-input-group {
  display: flex;
  flex-direction: column;
}

.macro-input-label {
  font-size: 14px;
  font-weight: 500;
  color: #374151;
  margin-bottom: 8px;
}

.macro-wrapper {
  margin-bottom: 0;
}

.macro-input {
  padding: 12px 16px;
  border: 1px solid #d1d5db;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 500;
  color: #1f2937;
  background: white;
  transition: all 0.2s ease;
}

.macro-input:focus {
  outline: none;
  border-color: #8b5cf6;
  box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
}

/* Notes Section */
.notes-section {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.notes-wrapper {
  margin-bottom: 0;
}

.notes-textarea {
  width: 100%;
  padding: 16px;
  border: 1px solid #d1d5db;
  border-radius: 8px;
  font-size: 14px;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
  color: #374151;
  background: white;
  resize: vertical;
  min-height: 120px;
  transition: all 0.2s ease;
  line-height: 1.5;
}

.notes-textarea:focus {
  outline: none;
  border-color: #8b5cf6;
  box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
}

.notes-textarea::placeholder {
  color: #9ca3af;
  font-style: italic;
}

.checkbox-section {
  margin-top: 8px;
}

.checkbox-container {
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
  user-select: none;
  position: relative;
}

.notes-checkbox {
  opacity: 0;
  position: absolute;
  cursor: pointer;
}

.checkmark {
  width: 20px;
  height: 20px;
  background: white;
  border: 2px solid #d1d5db;
  border-radius: 4px;
  position: relative;
  transition: all 0.2s ease;
  flex-shrink: 0;
}

.checkbox-container:hover .checkmark {
  border-color: #8b5cf6;
}

.notes-checkbox:checked + .checkmark {
  background: #8b5cf6;
  border-color: #8b5cf6;
}

.notes-checkbox:checked + .checkmark:after {
  content: '';
  position: absolute;
  left: 6px;
  top: 2px;
  width: 6px;
  height: 10px;
  border: solid white;
  border-width: 0 2px 2px 0;
  transform: rotate(45deg);
}

.checkbox-label {
  font-size: 14px;
  color: #374151;
  font-weight: 500;
  line-height: 1.4;
}

/* Visual Summary */
.visual-summary {
  display: grid;
  grid-template-areas: 
    "calories timeline"
    "macros macros";
  grid-template-columns: auto 1fr;
  gap: 32px;
  align-items: start;
}

.calories-display {
  grid-area: calories;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.calories-number {
  font-size: 48px;
  font-weight: 700;
  color: #1f2937;
  line-height: 1;
  margin-bottom: 4px;
}

.calories-label {
  font-size: 14px;
  color: #6b7280;
  font-weight: 500;
}

.plan-timeline {
  grid-area: timeline;
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding-left: 32px;
}

.timeline-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.timeline-label {
  font-size: 14px;
  color: #374151;
  font-weight: 500;
}

.timeline-end {
  font-size: 14px;
  color: #6b7280;
  font-weight: 500;
}

.timeline-bar {
  height: 8px;
  background: #f3f4f6;
  border-radius: 4px;
  position: relative;
  overflow: hidden;
}

.timeline-progress {
  height: 100%;
  background: linear-gradient(90deg, #8b5cf6 0%, #ec4899 100%);
  border-radius: 4px;
  width: 100%;
  position: relative;
}

.macros-legend {
  grid-area: macros;
  display: flex;
  gap: 24px;
  justify-content: flex-start;
  margin-top: 16px;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 8px;
}

.legend-dot {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  flex-shrink: 0;
}

.carbs-dot {
  background: #3b82f6;
}

.protein-dot {
  background: #10b981;
}

.fat-dot {
  background: #f59e0b;
}

.legend-text {
  font-size: 14px;
  color: #374151;
  font-weight: 500;
}

/* Meal Sections */
.meal-section {
  display: grid;
  grid-template-columns: 120px 1fr 120px;
  gap: 16px;
  align-items: start;
  margin-bottom: 20px;
  padding: 16px;
  background: #f8fafc;
  border-radius: 8px;
}

.meal-title {
  font-size: 14px;
  font-weight: 600;
  color: #1f2937;
  margin: 0;
  padding-top: 8px;
}

.meal-textarea {
  border: 1px solid #d1d5db;
  border-radius: 6px;
  padding: 8px 12px;
  font-size: 13px;
  resize: none;
  background: white;
}

.meal-calories {
  display: flex;
  align-items: center;
  gap: 4px;
}

.calorie-input {
  width: 70px;
  padding: 8px 12px;
  border: 1px solid #d1d5db;
  border-radius: 6px;
  font-size: 13px;
  text-align: center;
}

.calorie-unit {
  font-size: 12px;
  color: #6b7280;
  font-weight: 500;
}

/* Form Actions */
.form-actions {
  display: flex;
  gap: 16px;
  justify-content: flex-end;
  padding: 24px;
  background: white;
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  margin-top: 24px;
}

/* Right Sidebar */
.right-sidebar {
  width: 340px;
  padding: 32px 24px 32px 0;
  display: flex;
  flex-direction: column;
  gap: 24px;
}

.sidebar-card {
  background: white;
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  padding: 24px;
}

.card-title {
  font-size: 18px;
  font-weight: 700;
  color: #1f2937;
  margin: 0 0 20px 0;
  display: flex;
  align-items: center;
  gap: 8px;
}

/* AI Copilot */
.copilot-icon {
  font-size: 20px;
}

.copilot-input-group {
  display: flex;
  gap: 8px;
  margin-bottom: 20px;
}

.copilot-input {
  flex: 1;
  padding: 12px 16px;
  border: 1px solid #d1d5db;
  border-radius: 8px;
  font-size: 14px;
  outline: none;
}

.copilot-input:focus {
  border-color: #8b5cf6;
  box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
}

.copilot-button {
  background: #8b5cf6;
  color: white;
  border: none;
  border-radius: 8px;
  padding: 12px 16px;
  font-size: 16px;
  cursor: pointer;
}

.copilot-button:hover {
  background: #7c3aed;
}

.quick-suggestions {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.suggestion-item {
  background: #f8fafc;
  color: #8b5cf6;
  padding: 8px 12px;
  border-radius: 6px;
  font-size: 13px;
  cursor: pointer;
  border: 1px solid #e5e7eb;
  transition: all 0.2s ease;
}

.suggestion-item:hover {
  background: #ede9fe;
  border-color: #d8b4fe;
}

/* Alerts */
.alert-item {
  display: flex;
  gap: 12px;
  padding: 16px;
  border-radius: 8px;
  margin-bottom: 12px;
}

.alert-warning {
  background: #fffbeb;
  border: 1px solid #fde68a;
}

.alert-icon {
  font-size: 16px;
  flex-shrink: 0;
  margin-top: 2px;
}

.alert-content {
  display: flex;
  flex-direction: column;
}

.alert-title {
  font-weight: 600;
  font-size: 14px;
  color: #1f2937;
  margin-bottom: 4px;
}

.alert-description {
  font-size: 13px;
  color: #6b7280;
  line-height: 1.4;
}

/* Simple Form Overrides */
.input-wrapper {
  margin-bottom: 0;
}

.input-wrapper label {
  font-weight: 500;
  color: #374151;
  margin-bottom: 8px;
  font-size: 14px;
}

.input-wrapper input,
.input-wrapper select,
.input-wrapper textarea {
  padding: 12px 16px;
  border: 1px solid #d1d5db;
  border-radius: 8px;
  font-size: 14px;
  transition: all 0.2s ease;
}

.input-wrapper input:focus,
.input-wrapper select:focus,
.input-wrapper textarea:focus {
  outline: none;
  border-color: #8b5cf6;
  box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
}

/* Responsive */
@media (max-width: 1200px) {
  .form-grid {
    grid-template-columns: 1fr;
  }
  
  .macros-inputs {
    grid-template-columns: 1fr;
  }
  
  .meal-section {
    grid-template-columns: 1fr;
    gap: 12px;
  }
}

@media (max-width: 768px) {
  .nutrition-plan-layout {
    flex-direction: column;
  }
  
  .left-sidebar, .right-sidebar {
    width: 100%;
  }
  
  .main-content {
    max-width: 100%;
  }
  
  .page-title-section {
    flex-direction: column;
    gap: 16px;
  }
  
  .macros-inputs {
    grid-template-columns: 1fr;
  }
  
  .caloric-slider-container {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
  }

  .visual-summary {
    grid-template-areas: 
      "calories"
      "timeline"
      "macros";
    grid-template-columns: 1fr;
    gap: 24px;
    text-align: center;
  }

  .plan-timeline {
    padding-left: 0;
  }

  .macros-legend {
    justify-content: center;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const slider = document.getElementById('caloricSlider');
  const valueDisplay = document.getElementById('caloricValue');
  const summaryCalories = document.querySelector('.calories-number');
  
  // Update calories display
  function updateCalories(value) {
    if (valueDisplay) valueDisplay.textContent = value;
    if (summaryCalories) summaryCalories.textContent = value;
  }
  
  // Slider event listener
  if (slider && valueDisplay) {
    slider.addEventListener('input', function() {
      updateCalories(this.value);
    });
  }

  // Calculate and update macro percentages
  function updateMacroPercentages() {
    const proteinInput = document.querySelector('input[name*="protein"]');
    const carbsInput = document.querySelector('input[name*="carbs"]');
    const fatInput = document.querySelector('input[name*="fat"]');
    
    if (proteinInput && carbsInput && fatInput) {
      const protein = parseFloat(proteinInput.value) || 0;
      const carbs = parseFloat(carbsInput.value) || 0;
      const fat = parseFloat(fatInput.value) || 0;
      
      const proteinCal = protein * 4;
      const carbsCal = carbs * 4;
      const fatCal = fat * 9;
      const totalCal = proteinCal + carbsCal + fatCal;
      
      if (totalCal > 0) {
        const proteinPercent = Math.round((proteinCal / totalCal) * 100);
        const carbsPercent = Math.round((carbsCal / totalCal) * 100);
        const fatPercent = Math.round((fatCal / totalCal) * 100);
        
        // Update legend text
        const legends = document.querySelectorAll('.legend-text');
        if (legends[0]) legends[0].textContent = `${carbsPercent}% C`;
        if (legends[1]) legends[1].textContent = `${proteinPercent}% P`;
        if (legends[2]) legends[2].textContent = `${fatPercent}% F`;
      }
    }
  }

  // Add event listeners to macro inputs
  const macroInputs = document.querySelectorAll('.macro-input');
  macroInputs.forEach(input => {
    input.addEventListener('input', updateMacroPercentages);
  });

  // Set timeline end date (30 days from now)
  const endDate = new Date();
  endDate.setDate(endDate.getDate() + 30);
  const timelineEnd = document.querySelector('.timeline-end');
  if (timelineEnd) {
    const options = { day: 'numeric', month: 'short' };
    timelineEnd.textContent = endDate.toLocaleDateString('es-ES', options);
  }

  // Initial calculations
  updateMacroPercentages();
});
</script>
